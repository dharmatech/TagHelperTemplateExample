@page "/pages/form/{id:long?}"
@model FormHandlerModel
@using Microsoft.AspNetCore.Mvc.RazorPages
@using Microsoft.EntityFrameworkCore

@{ 
    @*async Task Template(string label, string asp_for)
    {
        <div class="form-group">

            <label>@label</label>

            <input class="form-control" asp-for="@asp_for" />

        </div>
    }*@

    @*async Task Template(string label, ModelExpression expr)
    {
        var abc = new ViewDataDictionary(null);

        // ModelExpressionProvider.CreateModelExpression(abc, xyz => Product.Name);

        ModelExpressionProvider.CreateModelExpression(abc, );

        <div class="form-group">

            <label>@label</label>

            <input class="form-control" asp-for="@expr" />

        </div>
    }*@

    async Task Template(string label, ModelExpression expr)
    {
        <div class="form-group">

            <label>@label</label>

            <input class="form-control" asp-for="@expr.Model" />

        </div>
    }

}

<div class="m-2">
    <h5 class="bg-primary text-white text-center p-2">HTML Form</h5>
    <form asp-page="FormHandler" method="post" id="htmlform">

        @{ 
            //var result_a = Model.HtmlHelper;

            //var xyz = ModelExpressionProvider.CreateModelExpression(new ViewDataDictionary<string>(), abc => Product.Name);

            //await Template("Name", new ModelExpression("Product.Name", abc));

            // await Template("Name", "Product.Name");

            await Template("Name", Model.create("Product.Name"));
            await Template("Price", Model.create("Product.Price"));
            await Template("Category", Model.create("Product.Category.Name"));
            await Template("Supplier", Model.create("Product.Supplier.Name"));

        }

        @*<div class="form-group">
            <label>Name</label>
            <input class="form-control" asp-for="Product.Name" />
        </div>

        <div class="form-group">
            <label>Price</label>
            <input class="form-control" asp-for="Product.Price" />
        </div>

        <div class="form-group">
            <label>Category</label>
            <input class="form-control" asp-for="Product.Category.Name" />
        </div>

        <div class="form-group">
            <label>Supplier</label>
            <input class="form-control" asp-for="Product.Supplier.Name" />
        </div>*@

        <button type="submit" class="btn btn-primary">Submit</button>
    </form>
    <button form="htmlform" asp-page="FormHandler" class="btn btn-primary mt-2">
        Sumit (Outside Form)
    </button>
</div>

@functions {

    ////[IgnoreAntiforgeryToken]
    //public class FormHandlerModel : PageModel {
    //    private DataContext context;

    //    public FormHandlerModel(DataContext dbContext) {
    //        context = dbContext;
    //    }

    //    public Product Product { get; set; }

    //    public async Task OnGetAsync(long id = 1) {
    //        Product = await context.Products.Include(p => p.Category)
    //            .Include(p => p.Supplier).FirstAsync(p => p.ProductId == id);
    //    }

    //    public IActionResult OnPost() {
    //        foreach (string key in Request.Form.Keys
    //                .Where(k => !k.StartsWith("_"))) {
    //            TempData[key] = string.Join(", ", Request.Form[key]);
    //        }
    //        return RedirectToPage("FormResults");
    //    }
    //}
}
